{"version":3,"file":"start.js","sourceRoot":"","sources":["../../src/start.ts"],"names":[],"mappings":";;;AAAA;;;;;;;;;;;;;;GAcG;AACH,gEAGsC;AACtC,4CAA6D;AAC7D,mCAIiB;AACjB,oEAA0E;AAG1E;;;GAGG;AACH,SAAgB,YAAY,CAAC,UAAsB;IAGjD,MAAM,aAAa,GAAkB,IAAA,mCAAmB,GAAE,CAAC;IAC3D,MAAM,MAAM,GAAG,aAAa,CAAC,cAAc,EAAE,CAAC;IAE9C,IAAI,MAAM,CAAC,QAAQ,EAAE;QACnB,UAAI,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC;QAC3C,OAAO,QAAQ,CAAC;KACjB;IACD,IAAI,MAAM,CAAC,SAAS,IAAI,IAAI,EAAE;QAC5B,UAAI,CAAC,SAAS,CAAC,IAAI,uBAAiB,EAAE,EAAE,EAAE,QAAQ,EAAE,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC;KACzE;IAED,IAAA,0CAAwB,EAAC;QACvB,gBAAgB,EAAE,UAAU,EAAE,gBAAgB,EAAE,IAAI,EAAE,IAAI,EAAE;KAC7D,CAAC,CAAC;IACH,IAAA,kCAA0B,GAAE,CAAC;IAC7B,IAAA,uBAAe,EACb,UAAU,EAAE,iBAAiB,KAAK,IAAI;QACpC,CAAC,CAAC,IAAI,CAAC,wBAAwB;QAC/B,CAAC,CAAC,CAAC,UAAU,EAAE,iBAAiB;YAC5B,IAAA,sCAA8B,EAAC,MAAM,CAAC,CAAC,CAC9C,CAAC;IAEF,MAAM,UAAU,GAAG,KAAK,IAAI,EAAE;QAC5B,MAAM,QAAQ,GAAuB,EAAE,CAAC;QACxC,MAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC9B,CAAC,CAAC;IACF,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC;AAClC,CAAC;AA9BD,oCA8BC;AACD,MAAM,QAAQ,GAAG;IACf,QAAQ,EAAE,KAAK,IAAI,EAAE,GAAE,CAAC;CACzB,CAAC","sourcesContent":["/*\n * Copyright The OpenTelemetry Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  ConfigFactory,\n  createConfigFactory,\n} from '@opentelemetry/configuration';\nimport { diag, DiagConsoleLogger } from '@opentelemetry/api';\nimport {\n  getPropagatorFromConfiguration,\n  setupDefaultContextManager,\n  setupPropagator,\n} from './utils';\nimport { registerInstrumentations } from '@opentelemetry/instrumentation';\nimport type { SDKOptions } from './types';\n\n/**\n * @experimental Function to start the OpenTelemetry Node SDK\n * @param sdkOptions\n */\nexport function startNodeSDK(sdkOptions: SDKOptions): {\n  shutdown: () => Promise<void>;\n} {\n  const configFactory: ConfigFactory = createConfigFactory();\n  const config = configFactory.getConfigModel();\n\n  if (config.disabled) {\n    diag.info('OpenTelemetry SDK is disabled');\n    return NOOP_SDK;\n  }\n  if (config.log_level != null) {\n    diag.setLogger(new DiagConsoleLogger(), { logLevel: config.log_level });\n  }\n\n  registerInstrumentations({\n    instrumentations: sdkOptions?.instrumentations?.flat() ?? [],\n  });\n  setupDefaultContextManager();\n  setupPropagator(\n    sdkOptions?.textMapPropagator === null\n      ? null // null means don't set.\n      : (sdkOptions?.textMapPropagator ??\n          getPropagatorFromConfiguration(config))\n  );\n\n  const shutdownFn = async () => {\n    const promises: Promise<unknown>[] = [];\n    await Promise.all(promises);\n  };\n  return { shutdown: shutdownFn };\n}\nconst NOOP_SDK = {\n  shutdown: async () => {},\n};\n"]}