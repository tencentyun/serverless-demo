{"version":3,"file":"meta.d.ts","names":["InteropZodObject","InteropZodType","InteropZodObjectShape","BaseChannel","META_EXTRAS_DESCRIPTION_PREFIX","ReducedZodChannel","T","TReducerSchema","InteropZodToStateDefinition","TShape","key","Schema","ReducerSchema","V","U","UpdateType","SchemaMeta","TValue","TUpdate","SchemaMetaRegistry","WeakMap","Map","schemaMetaRegistry","withLangGraph","TSchema"],"sources":["../../../src/graph/zod/meta.d.ts"],"sourcesContent":["import { InteropZodObject, InteropZodType, InteropZodObjectShape } from \"@langchain/core/utils/types\";\nimport { BaseChannel } from \"../../channels/base.js\";\nexport declare const META_EXTRAS_DESCRIPTION_PREFIX = \"lg:\";\n/** @internal */\nexport type ReducedZodChannel<T extends InteropZodType, TReducerSchema extends InteropZodType> = T & {\n    lg_reducer_schema: TReducerSchema;\n};\n/** @internal */\nexport type InteropZodToStateDefinition<T extends InteropZodObject, TShape = InteropZodObjectShape<T>> = {\n    [key in keyof TShape]: TShape[key] extends ReducedZodChannel<infer Schema, infer ReducerSchema> ? Schema extends InteropZodType<infer V> ? ReducerSchema extends InteropZodType<infer U> ? BaseChannel<V, U> : never : never : TShape[key] extends InteropZodType<infer V, infer U> ? BaseChannel<V, U> : never;\n};\nexport type UpdateType<T extends InteropZodObject, TShape = InteropZodObjectShape<T>> = {\n    [key in keyof TShape]?: TShape[key] extends ReducedZodChannel<infer Schema, infer ReducerSchema> ? Schema extends InteropZodType<unknown> ? ReducerSchema extends InteropZodType<infer U> ? U : never : never : TShape[key] extends InteropZodType<unknown, infer U> ? U : never;\n};\nexport interface SchemaMeta<TValue = any, TUpdate = TValue> {\n    jsonSchemaExtra?: {\n        langgraph_nodes?: string[];\n        langgraph_type?: \"prompt\" | \"messages\";\n        [key: string]: unknown;\n    };\n    reducer?: {\n        schema?: InteropZodType<TUpdate>;\n        fn: (a: TValue, b: TUpdate) => TValue;\n    };\n    default?: () => TValue;\n}\n/**\n * A registry for storing and managing metadata associated with schemas.\n * This class provides methods to get, extend, remove, and check metadata for a given schema.\n */\nexport declare class SchemaMetaRegistry {\n    /**\n     * Internal map storing schema metadata.\n     * @internal\n     */\n    _map: WeakMap<InteropZodType, SchemaMeta<any, any>>;\n    /**\n     * Cache for extended schfemas.\n     * @internal\n     */\n    _extensionCache: Map<string, WeakMap<InteropZodType, InteropZodType>>;\n    /**\n     * Retrieves the metadata associated with a given schema.\n     * @template TValue The value type of the schema.\n     * @template TUpdate The update type of the schema (defaults to TValue).\n     * @param schema The schema to retrieve metadata for.\n     * @returns The associated SchemaMeta, or undefined if not present.\n     */\n    get<TValue, TUpdate = TValue>(schema: InteropZodType<TValue>): SchemaMeta<TValue, TUpdate> | undefined;\n    /**\n     * Extends or sets the metadata for a given schema.\n     * @template TValue The value type of the schema.\n     * @template TUpdate The update type of the schema (defaults to TValue).\n     * @param schema The schema to extend metadata for.\n     * @param predicate A function that receives the existing metadata (or undefined) and returns the new metadata.\n     */\n    extend<TValue, TUpdate>(schema: InteropZodType<TValue>, predicate: (meta: SchemaMeta<TValue, TUpdate> | undefined) => SchemaMeta<TValue, TUpdate>): void;\n    /**\n     * Removes the metadata associated with a given schema.\n     * @param schema The schema to remove metadata for.\n     * @returns The SchemaMetaRegistry instance (for chaining).\n     */\n    remove(schema: InteropZodType): this;\n    /**\n     * Checks if metadata exists for a given schema.\n     * @param schema The schema to check.\n     * @returns True if metadata exists, false otherwise.\n     */\n    has(schema: InteropZodType): boolean;\n    /**\n     * Returns a mapping of channel instances for each property in the schema\n     * using the associated metadata in the registry.\n     *\n     * This is used to create the `channels` object that's passed to the `Graph` constructor.\n     *\n     * @template T The shape of the schema.\n     * @param schema The schema to extract channels from.\n     * @returns A mapping from property names to channel instances.\n     */\n    getChannelsForSchema<T extends InteropZodObject>(schema: T): InteropZodToStateDefinition<T>;\n    /**\n     * Returns a modified schema that introspectively looks at all keys of the provided\n     * object schema, and applies the augmentations based on meta provided with those keys\n     * in the registry and the selectors provided in the `effects` parameter.\n     *\n     * This assumes that the passed in schema is the \"root\" schema object for a graph where\n     * the keys of the schema are the channels of the graph. Because we need to represent\n     * the input of a graph in a couple of different ways, the `effects` parameter allows\n     * us to apply those augmentations based on pre determined conditions.\n     *\n     * @param schema The root schema object to extend.\n     * @param effects The effects that are being applied.\n     * @returns The extended schema.\n     */\n    getExtendedChannelSchemas<T extends InteropZodObject>(schema: T, effects: {\n        /**\n         * Augments the shape by using the reducer's schema if it exists\n         */\n        withReducerSchema?: boolean;\n        /**\n         * Applies the stringified jsonSchemaExtra as a description to the schema.\n         */\n        withJsonSchemaExtrasAsDescription?: boolean;\n        /**\n         * Applies the `.partial()` modifier to the schema.\n         */\n        asPartial?: boolean;\n    }): InteropZodObject;\n}\nexport declare const schemaMetaRegistry: SchemaMetaRegistry;\nexport declare function withLangGraph<TValue, TUpdate, TSchema extends InteropZodType<TValue>>(schema: TSchema, meta: SchemaMeta<TValue, TUpdate> & {\n    reducer?: undefined;\n}): TSchema;\nexport declare function withLangGraph<TValue, TUpdate, TSchema extends InteropZodType<TValue>>(schema: TSchema, meta: SchemaMeta<TValue, TUpdate>): ReducedZodChannel<TSchema, InteropZodType<TUpdate>>;\n"],"mappings":"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"}