import type { BaseFileOperator } from "../base-operator";
import type { InMemoryFileOperator } from "../in-memory-operator";
export interface TransactionOperation {
    type: "write" | "mkdir" | "unlink" | "rmdir" | "rename";
    path: string;
    oldPath?: string;
    timestamp: number;
}
export interface FileState {
    exists: boolean;
    isDirectory: boolean;
    contentLoader?: () => Promise<Buffer>;
}
export declare abstract class SnapshotStrategy {
    abstract initialize(): Promise<void>;
    abstract saveFile(path: string, fileState: FileState): Promise<void>;
    abstract rollback(operations: TransactionOperation[]): Promise<void>;
    abstract cleanup(): Promise<void>;
}
export declare class LocalSnapshotStrategy extends SnapshotStrategy {
    private backupDir;
    private backupPaths;
    private createdPaths;
    initialize(): Promise<any>;
    saveFile(path: string, fileState: FileState): Promise<void>;
    rollback(operations: TransactionOperation[]): Promise<void>;
    private rollbackOperation;
    private restoreFile;
    cleanup(): Promise<void>;
}
export declare class MemorySnapshotStrategy extends SnapshotStrategy {
    private operator;
    private snapshot;
    private vol;
    private fs;
    constructor(operator: InMemoryFileOperator);
    initialize(): Promise<any>;
    saveFile(path: string, fileState: FileState): Promise<void>;
    rollback(operations: TransactionOperation[]): Promise<void>;
    cleanup(): Promise<void>;
}
export declare class SandboxSnapshotStrategy extends SnapshotStrategy {
    private operator;
    private fileSnapshots;
    private createdPaths;
    constructor(operator: BaseFileOperator);
    initialize(): Promise<any>;
    saveFile(path: string, fileState: FileState): Promise<void>;
    rollback(operations: TransactionOperation[]): Promise<void>;
    private rollbackOperation;
    private restoreFile;
    cleanup(): Promise<void>;
}
//# sourceMappingURL=snapshot-strategies.d.ts.map